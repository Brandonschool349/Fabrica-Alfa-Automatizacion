<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>F√°brica Alfa ‚Äî Dashboard SaaS (Neumorphism Oscuro)</title>

  <!-- Bootstrap (utilidades) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Estilos (externo: style.css) -->
  <link rel="stylesheet" href="/web/style.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="app-root">
    <!-- SIDEBAR SaaS -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-top">
        <div class="brand">
          <div class="logo">FA</div>
          <div class="brand-text">
            <div class="title">F√°brica Alfa</div>
            <div class="subtitle">Control & Anal√≠tica</div>
          </div>
        </div>

        <div class="search-wrap">
          <input id="sidebarSearch" class="form-control" placeholder="Buscar..." />
        </div>

        <nav class="nav-list" role="navigation" aria-label="main">
          <button class="nav-item active" data-view="dashboard"><span class="nav-ico">üè†</span><span class="nav-label">Dashboard</span></button>
          <button class="nav-item" data-view="estadisticas"><span class="nav-ico">üìä</span><span class="nav-label">Estad√≠sticas</span></button>
          <button class="nav-item" data-view="modelos"><span class="nav-ico">üßÆ</span><span class="nav-label">Modelos Prob.</span></button>
          <button class="nav-item" data-view="produccion"><span class="nav-ico">üè≠</span><span class="nav-label">Control Producci√≥n</span></button>
          <button class="nav-item" data-view="operario"><span class="nav-ico">üë∑</span><span class="nav-label">√Årea Operario</span></button>
        </nav>
      </div>

      <!-- <div class="sidebar-preview">
        <div class="muted small">Preview (screenshot)</div>
        <img src="./mnt/data/db883e4d-50fb-45de-acfb-6025188e3e99.png" alt="preview" class="preview-img" />
      </div> -->

      <div class="sidebar-bottom">
        <div class="user-info">
          <div class="small-muted">Usuario</div>
          <div id="userNameDisplay" class="user-name">‚Äî</div>
        </div>
        <div class="sidebar-actions">
          <button id="btnUpload" class="btn btn-sm btn-outline-light" title="Subir datos">üìÅ Subir</button>
          <button id="btnLogout" class="btn btn-sm btn-danger" title="Cerrar sesi√≥n">Cerrar sesi√≥n</button>
        </div>
        <div class="api-status muted">API: <span id="apiStatus">desconocida</span></div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
      <!-- Topbar -->
      <header class="topbar">
        <div class="top-left">
          <h4>Panel de Control ‚Äî <span class="accent">F√°brica Alfa</span></h4>
          <div class="muted">Neumorphism oscuro ¬∑ SaaS moderno</div>
        </div>
        <div class="top-right">
          <div id="roleBadge" class="role-badge muted">Sin sesi√≥n</div>
        </div>
      </header>

      <!-- Views container -->
      <section class="views">

        <!-- DASHBOARD VIEW -->
        <section id="view-dashboard" class="view-pane active">
          <div class="grid grid-2-1">
            <!-- LEFT: KPIs + upload -->
            <div>
              <div class="card kpi-card">
                <div class="kpi-row">
                  <div>
                    <div class="muted">Registros cargados</div>
                    <div id="kpiRecords" class="kpi-value">0</div>
                  </div>
                  <div>
                    <div class="muted">Columnas detectadas</div>
                    <div id="kpiCols" class="kpi-value">‚Äî</div>
                  </div>
                </div>
                <div class="mt-3">
                  <label class="muted small">Cargar base (CSV / XLSX)</label>
                  <div style="display:flex; gap:8px; margin-top:8px;">
                    <input id="fileInput" type="file" accept=".csv,.xlsx" class="form-control">
                    <button id="uploadBtn" class="btn btn-primary">Subir</button>
                    <button id="clearBtn" class="btn btn-outline-light">Limpiar</button>
                  </div>
                  <div id="uploadMsg" class="muted" style="margin-top:8px;">Esperando archivo...</div>
                </div>
              </div>

              <div class="card metrics-card">
                <h5>Medidas r√°pidas</h5>
                <div class="form-row" style="margin-top:8px;">
                  <select id="selectQuick" class="form-select"></select>
                  <button id="btnQuickCalc" class="btn btn-primary">Calcular</button>
                </div>
                <div class="metrics mt-3">
                  <div><div class="muted">Media</div><div id="quickMedia" class="metric">‚Äî</div></div>
                  <div><div class="muted">Mediana</div><div id="quickMediana" class="metric">‚Äî</div></div>
                  <div><div class="muted">Moda</div><div id="quickModa" class="metric">‚Äî</div></div>
                </div>
              </div>

              <div class="card small-card">
                <h6>Resumen</h6>
                <div id="summaryBlock" class="muted">Sin datos.</div>
              </div>
            </div>

            <!-- RIGHT: Charts -->
            <div>
              <div class="card chart-card">
                <h5>Ventas vs Unidades</h5>
                <canvas id="scatterChart"></canvas>
                <div id="scatterMsg" class="muted mt-2">Cargar datos para visualizar.</div>
              </div>

              <div class="card chart-card mt-3">
                <h5>Histograma ‚Äî Unidades</h5>
                <canvas id="histUnidades"></canvas>
                <div id="histMsg" class="muted mt-2">Cargar datos para visualizar.</div>
              </div>
            </div>
          </div>
        </section>

        <!-- ESTADISTICAS VIEW -->
        <section id="view-estadisticas" class="view-pane hidden">
          <div class="grid grid-3">
            <div class="card">
              <h5>Medidas de tendencia central</h5>
              <select id="selectTend" class="form-select mt-2"></select>
              <div style="display:flex; gap:8px; margin-top:10px;">
                <button id="btnTend" class="btn btn-primary">Calcular</button>
                <button id="btnTendAuto" class="btn btn-outline-light">Auto</button>
              </div>
              <div class="mt-3">
                <div class="muted">Media</div><div id="mediaVal" class="metric">‚Äî</div>
                <div class="muted">Mediana</div><div id="medianaVal" class="metric">‚Äî</div>
                <div class="muted">Moda</div><div id="modaVal" class="metric">‚Äî</div>
              </div>
            </div>

            <div class="card">
              <h5>Medidas de dispersi√≥n</h5>
              <select id="selectDisp" class="form-select mt-2"></select>
              <button id="btnDisp" class="btn btn-warning w-100 mt-3">Calcular</button>
              <div class="mt-3">
                <div class="muted">Desviaci√≥n</div><div id="sdVal" class="metric">‚Äî</div>
                <div class="muted">Varianza</div><div id="varVal" class="metric">‚Äî</div>
                <div class="muted">IQR</div><div id="iqrVal" class="metric">‚Äî</div>
              </div>
            </div>

            <div class="card">
              <h5>Probabilidades & Tests</h5>
              <div style="display:flex; gap:8px;">
                <input id="binN" type="number" class="form-control" placeholder="n">
                <input id="binP" type="number" class="form-control" step="0.01" placeholder="p">
              </div>
              <button id="btnBinom" class="btn btn-primary w-100 mt-2">Generar Binomial</button>
              <canvas id="chartBinomial" class="mt-3"></canvas>
            </div>
          </div>
        </section>

        <!-- MODELOS VIEW (Gerente + Supervisor) -->
        <section id="view-modelos" class="view-pane hidden">
          <div class="card">
            <h5>Modelos probabil√≠sticos & tests avanzados</h5>
            <div class="muted">Aqu√≠ se mostrar√°n im√°genes generadas por el backend (matplotlib/seaborn) y resultados de ANOVA, regresi√≥n, etc.</div>
            <div style="display:flex; gap:8px; margin-top:12px;">
              <button id="btnANOVA" class="btn btn-outline-light">Generar ANOVA (POST)</button>
              <button id="btnRegresion" class="btn btn-outline-light">Regresi√≥n</button>
              <button id="btnCorrelacion" class="btn btn-outline-light">Correlaci√≥n</button>
            </div>

            <div id="modelResults" style="margin-top:12px;"></div>
          </div>
        </section>

        <!-- PRODUCCION VIEW -->
        <section id="view-produccion" class="view-pane hidden">
          <div class="card">
            <h5>Control de Producci√≥n</h5>
            <div class="muted">Estado de pedidos, desempe√±o por responsable, an√°lisis de defectos.</div>
            <div id="produccionBlock" class="muted mt-3">Sin datos.</div>
          </div>
        </section>

        <!-- OPERARIO VIEW -->
        <section id="view-operario" class="view-pane hidden">
          <div class="card">
            <h5>√Årea del Operario</h5>
            <div class="muted">Vista simplificada: unidades por mes, gr√°ficos simples y su propio rendimiento.</div>
            <div id="operarioBlock" class="muted mt-3">Sin datos.</div>
          </div>
        </section>

      </section>

      <footer class="app-footer">
        Proyecto escolar ‚Äî F√°brica Alfa ¬∑ Equipo de Ingenier√≠a
      </footer>
    </main>
  </div>

  <!-- Login fullscreen (simple) -->
  <div id="loginModal" class="login-modal hidden">
    <div class="login-card">
      <h3>Iniciar sesi√≥n</h3>
      <input id="loginUser" class="form-control mt-2" placeholder="Usuario (admin / supervisor / operario)">
      <input id="loginPass" type="password" class="form-control mt-2" placeholder="Contrase√±a">
      <div style="display:flex; gap:8px; margin-top:12px;">
        <button id="loginBtn" class="btn btn-primary">Entrar</button>
        <button id="loginClose" class="btn btn-outline-light">Cerrar</button>
      </div>
      <div id="loginMsg" class="muted mt-2"></div>
    </div>
  </div>

  <!-- Enlazamos el JS (app.js) -->
  <script src="/web/app.js"></script>
</body>
</html>
